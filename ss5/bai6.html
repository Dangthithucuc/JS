<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Quản lý bạn đọc quá hạn</title>
</head>
<body>
<script>
   
    let readerCardIds = [];
    let readerNames = [];
    let borrowedBookCodes = [];
    let overdueDays = [];

    
    let n;
    do {
        n = +prompt("Hôm nay có bao nhiêu bạn đọc bị ghi nhận quá hạn?");
    } while (isNaN(n) || n <= 0);

    
    for (let i = 0; i < n; i++) {
        let cardId, name, books, days;

      
        do {
            cardId = prompt(`Nhập mã thẻ bạn đọc thứ ${i + 1}:`).trim();
            if (cardId === "") {
                alert("Mã thẻ không được để trống!");
            } else if (readerCardIds.includes(cardId)) {
                alert("Mã thẻ đã tồn tại!");
                cardId = "";
            }
        } while (cardId === "");

       
        do {
            name = prompt(`Nhập tên bạn đọc thứ ${i + 1}:`).trim();
            if (name === "") {
                alert("Tên bạn đọc không được để trống!");
            }
        } while (name === "");

       
        do {
            books = prompt(
                `Nhập các mã sách đang mượn (cách nhau bởi dấu phẩy):`
            ).trim();
            if (books === "") {
                alert("Danh sách mã sách không được để trống!");
            }
        } while (books === "");

       
        do {
            days = +prompt(`Nhập số ngày quá hạn:`);
            if (isNaN(days) || days < 0) {
                alert("Số ngày quá hạn phải là số ≥ 0!");
            }
        } while (isNaN(days) || days < 0);

       
        readerCardIds.push(cardId);
        readerNames.push(name);
        borrowedBookCodes.push(books);
        overdueDays.push(days);
    }

   

  
    let countOver10 = 0;
    for (let i = 0; i < n; i++) {
        if (overdueDays[i] >= 10) {
            countOver10++;
        }
    }
    console.log(`Tổng số bạn đọc quá hạn từ 10 ngày trở lên: ${countOver10}`);

   
    console.log("Danh sách mã thẻ bạn đọc mượn cả sách JS và PYT:");
    for (let i = 0; i < n; i++) {
        let bookArr = borrowedBookCodes[i]
            .toUpperCase()
            .split(",");

        let hasJS = false;
        let hasPYT = false;

        for (let j = 0; j < bookArr.length; j++) {
            let code = bookArr[j].trim();
            if (code.startsWith("JS")) hasJS = true;
            if (code.startsWith("PYT")) hasPYT = true;
        }

        if (hasJS && hasPYT) {
            console.log(readerCardIds[i]);
        }
    }

   
    let maxIndex = 0;
    for (let i = 1; i < n; i++) {
        if (overdueDays[i] > overdueDays[maxIndex]) {
            maxIndex = i;
        }
    }
    console.log(
        `Bạn đọc quá hạn nhiều nhất: ${readerNames[maxIndex]} (${overdueDays[maxIndex]} ngày)`
    );

    
    let countOver7 = 0;
    for (let i = 0; i < n; i++) {
        if (overdueDays[i] >= 7) {
            countOver7++;
        }
    }

    if (countOver7 === 0) {
        console.log("Tình hình trả sách hôm nay khá tốt!");
    } else if (countOver7 <= 4) {
        console.log("Cần gửi nhắc nhở cho một số bạn đọc!");
    } else {
        console.log("Tình trạng quá hạn nghiêm trọng! Cần liên hệ ngay!");
    }
</script>
</body>
</html>
